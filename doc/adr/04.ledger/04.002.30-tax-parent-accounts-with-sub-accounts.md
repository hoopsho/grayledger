# 04.002. 30 Immutable Tax-Ready Parent Accounts + Unlimited User Sub-Accounts

**Status:** accepted  
**Date:** 2025-11-19

## Context
Users want the comfort of creating their own detailed chart of accounts (“Advertising:Google”, “Meals:Team Lunch”, “COGS:Vinyl”),  
but at tax time the books must roll up perfectly into the ~30 lines the IRS actually cares about (Schedule C / 1065 / 1120-S).

## Decision
We ship exactly **30 immutable parent accounts** that are locked forever.  
Users can only create sub-accounts under them.

### The 30 sacred parent accounts (seeded at company creation)
```ruby
# db/seeds/parents.rb
parents = [
  # Assets
  "1000 Checking & Savings",
  "1200 Accounts Receivable",
  "1300 Inventory",
  "1500 Fixed Assets – Cost",
  "1600 Accumulated Depreciation",

  # Liabilities
  "2000 Credit Cards Payable",
  "2100 Accounts Payable",
  "2200 Loans Payable",
  "2500 Sales Tax Payable",

  # Equity
  "3000 Owner Equity / Capital",
  "3100 Owner Draws",
  "3900 Retained Earnings",

  # Revenue
  "4000 Gross Sales / Revenue",
  "4100 Refunds & Returns",

  # COGS
  "5000 Cost of Goods Sold",
  "5100 Merchant & Payment Fees",

  # Expenses (exact Schedule C lines)
  "6000 Advertising",
  "6050 Car & Truck Expenses",
  "6100 Contract Labor",
  "6200 Insurance",
  "6300 Interest Expense",
  "6400 Legal & Professional",
  "6500 Office Expense",
  "6600 Rent",
  "6700 Repairs & Maintenance",
  "6800 Supplies",
  "6900 Meals (50%)",
  "7000 Travel",
  "7100 Utilities",
  "7200 Home Office",
  "7300 Software & Subscriptions",
  "7990 Other Expenses"
]
Model
Rubyclass Account < ApplicationRecord
  include BelongsToCompany

  belongs_to :parent, class_name: "Account", optional: true
  has_many :sub_accounts, class_name: "Account", foreign_key: :parent_id, dependent: :destroy
  has_many :line_items

  validates :code, presence: true, uniqueness: { scope: :company_id }
  validates :name, presence: true
  enum account_type: { asset: 0, liability: 1, equity: 2, revenue: 3, expense: 4 }
  enum normal_balance: { debit: 0, credit: 1 }

  scope :parents, -> { where(parent_id: nil) }
end
Seeding
RubyCompany.find_each do |company|
  Current.company = company
  parents.each { |name| Account.create!(code: name[0..3], name: name, parent: nil, …) }
end
Users can create any sub-account under a parent (e.g., “6000 Advertising → 6010 Google Ads”, “6900 Meals → 6910 Team Lunch”).
All reports (P&L, Balance Sheet, tax export) use recursive CTE or materialized path to roll up to the 30 parents only.
Consequences

Tax package export is trivial and always perfect
Users get infinite flexibility without breaking compliance risk
No more “my categories don’t match the tax form” complaints
Zero extra gems, zero complexity

This is the pattern that finally kills the Xero/QuickBooks category nightmare.
Accepted.
