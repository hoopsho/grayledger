# 01.001. Rails 8 Minimal Stack — DHH-Approved, Future-Proof, Solo-Maintainable

**Status:** accepted  
**Date:** 2025-11-19

## Context
We are building a production-grade, AI-driven accounting application that must be:
- maintainable forever by 1–2 developers
- extremely fast to iterate
- cheap to run
- opinionated and boring (in the best way)

## Decision
We will use the absolute minimal, Rails-8-native, DHH-blessed stack:

| Layer              | Choice                                   | Reason |
|--------------------|------------------------------------------|--------|
| Framework          | Rails 8.0+                               | Latest Hotwire, Solid Queue, built-in authentication primitives |
| Asset pipeline     | Importmaps + TailwindCSS Rails           | Zero Node.js, zero build step |
| JS                | Hotwire (Turbo 8 + Stimulus 3) only      | No React/Vue forbidden |
| CSS                | TailwindCSS (via tailwindcss-rails gem)  | Utility-first, no custom CSS files |
| Database           | PostgreSQL + pgvector extension          | Embeddings + relational data in one place |
| Background jobs    | Solid Queue (built-in to Rails 8)        | No Redis, no Sidekiq, no extra infra |
| File storage       | Active Storage + S3 direct upload        | Rails native, zero server bandwidth |
| Authentication     | Rails 8 native credentials + custom OTP  | No Devise, no passwords |
| Authorization      | Pundit                                   | Simple, explicit, policy objects |
| Pagination         | Pagy                                     | Fastest, no dependencies |
| Money              | money-rails                              | Proper Money object, rounding safety |
| UI components      | Shared partials only (app/views/shared/) | No view_component gem, pure Rails partials + render |
| Business logic     | Skinny models/controllers → app/services, app/jobs, app/workers | Classic Rails way |

### Gems we explicitly allow (and nothing else)
```ruby
# Gemfile
gem "tailwindcss-rails"
gem "hotwire-rails"
gem "pundit"
gem "pagy"
gem "money-rails"
gem "pg"
gem "plaid"              # official client
gem "tax_cloud"
gem "solid_queue"
gem "mission_control-jobs"  # admin UI for Solid Queue
gem "letter_opener_web"  # dev only
No factory_bot, no rspec (we use Rails system tests + minitest), no dry-rb, no aasm, no whenever, no sidekiq, no good_job, no devise, no view_component.
```

## Consequences

- Development speed is insane (no build step, no yarn, no webpacker drama)
- Deploy is `git push heroku main`
- Monthly Heroku + AWS bill for first 1,000 customers < $300
- Every line of code is understandable by any Rails developer in 2025–2035
- We own the stack completely — no gem rot risk

This is the stack that will let one developer ship and support this product forever.
